# Отчёт по лабораторной работе #3. Настройка IPSec/IKEv2
* Выполнили Полеся Виталий, Скопецкий Анатолий
* б9118-09.03.04прогин

## Ход работы
### Настройка сервера
* Готовая ВМ
![](images/img0.png)

* Пользуемся автоматической установкой из QuickStart
![](images/img5.png)

* Скачиваем автоматический установщик, производим установку
![](images/img1.png)

* Успешная установка. Пользователь по умолчанию IKEv2
![](images/img3.png)

* В конец файла добавлена поддержка RSA1 для подключения клиентов Linux.
![](images/img8.png)

![](images/img9.png)

![](images/img10.png)

## Настройка клиента

* Пошаговая настройка клиента.
![](images/img7.png)

* Перейдём к пункту Linux.
![](images/img8.png)

* Установка strongswan - поддержку IKEv1 и IKEv2 протоколов.
![](images/img11.png)

* Проверяем наличие .p12 набора сертификатов и ключей клиента vpnclient.
![](images/img12.png)

* Подмонтировал эту же папку к файловой системе и открыл через проводник.
![](images/img13.png)

* Произвёл перемещение, извлёк из данного "ахрива" сертификаты и ключ шифрования.
![](images/img14.png)

* Произвёл настройку vpn в настройках системы.
![](images/img15.png)

![](images/img16.png)


## Проверка работоспособности
* Проверил работоспособность VPN. Фото без VPN...
![](images/img17.png)

* ... и через VPN.
![](images/img18.png)

* Проверка наличия перенаправления пакетов на 20.212.209.136. Перенаравление происходит. Выделенный "адаптер" под VPN не создаётся.
![](images/img22.png)

## Технические проблемы
* Не работало подключение через VPN. Никак. Для проверки, что проблема не на клиенте спустя получаса различных проверок установил на андроид strongSwan VPN Client. Получил отказ работы. Попробовал создать авторазвёртывание. На этапе установки софта оно работать отказалось. Немного подумав, заглянул в открытые порты, перенёс открытые UDP порты в основную ВМ и всё заработало. Скрин работы на ведре ниже. Два открытых UDP порта тоже ниже.

* Android
![](images/img19.jpg)
![](images/img20.jpg)

* UDP
![](images/img21.png)